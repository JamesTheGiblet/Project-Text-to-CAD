<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text to CAD Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three-js-csg@2.0.0/dist/three-js-csg.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/exporters/STLExporter.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/exporters/OBJExporter.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/exporters/GLTFExporter.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="panel">
            <h1>ðŸ”§ Text to CAD</h1>
            
            <div class="input-group">
                <label for="textInput">Describe your 3D object:</label>
                <textarea id="textInput" placeholder="e.g., 'Create a blue cube that is 2 units wide' or 'Make a red sphere with radius 1.5'"></textarea>
            </div>
            
            <button id="generate-btn">Generate Blueprint</button>
            <div class="examples">
                <h3 class="examples-title">ðŸ’¡ Try these examples:</h3>

                <div class="example" data-example-text="Create a cylinder with height 3. Then put a cone on top of it.">
                    <div class="example-title">Combined Shapes</div>
                    <div class="example-text">Create a cylinder with height 3. Then put a cone on top of it.</div>
                </div>

                <div class="example" data-example-text='Create a cube with size 3 named "base_box". Then create a cylinder with height 4 and unite it with the object named "base_box".'>
                    <div class="example-title">Named Union</div>
                    <div class="example-text">Name an object and then unite another with it.</div>
                </div>

                <div class="example" data-example-text='Create a cube with size 3. Then create a cylinder with height 4 and radius 0.5 and cut it through the cube.'>
                    <div class="example-title">Subtraction (Hole)</div>
                    <div class="example-text">See a 'ghost' of the tool shape before the CSG operation completes.</div>
                </div>

                <div class="example" data-example-text='Create a cube named "my_box". Then change the color of the object named "my_box" to green.'>
                    <div class="example-title">Change Color</div>
                    <div class="example-text">Create an object and then change its color by name.</div>
                </div>

                <div class="example" data-example-text='Create a cube named "my_box" at x -3. Then move the object named "my_box" to x 3, y 2.'>
                    <div class="example-title">Move Object</div>
                    <div class="example-text">Create an object and then move it by name.</div>
                </div>

                <div class="example" data-example-text='Create a cube named "my_box". Then rotate the object named "my_box" by 45 degrees on the y axis.'>
                    <div class="example-title">Rotate Named Object</div>
                    <div class="example-text">Create an object and then rotate it by name.</div>
                </div>

                <div class="example" data-example-text='Create a sphere named "my_sphere". Then scale the object named "my_sphere" by 2.'>
                    <div class="example-title">Scale Named Object</div>
                    <div class="example-text">Create an object and then scale it by name.</div>
                </div>

                <div class="example" data-example-text="Create a gear with 10 teeth, a radius of 3, and a hole radius of 1.">
                    <div class="example-title">Gear</div>
                    <div class="example-text">Create a gear with custom teeth and hole size.</div>
                </div>

                <div class="example" data-example-text="Create a pyramid with radius 1.5 and height 3.">
                    <div class="example-title">Pyramid</div>
                    <div class="example-text">Create a pyramid with radius 1.5 and height 3.</div>
                </div>
            </div>
            <div class="history">
                <div class="history-controls">
                    <h3 class="history-title">Command History</h3>
                    <div class="session-save-group">
                        <input type="text" id="session-name-input" placeholder="Session Name">
                        <button id="save-session-btn" class="control-btn-small">Save</button>
                    </div>
                </div>
                <ul id="history-list">
                </ul>
            </div>
            <div class="saved-sessions">
                <h3 class="sessions-title">Saved Sessions</h3>
                <ul id="saved-sessions-list"></ul>
            </div>
            <div id="properties-panel" class="properties-panel hidden">
                <div class="properties-header">
                    <h3 class="properties-title">Properties</h3>
                    <button id="duplicate-btn" class="control-btn-small">Duplicate</button>
                </div>
                <div class="prop-group">
                    <div class="prop-label">Name:</div>
                    <div id="prop-name" class="prop-value"></div>
                </div>
                <div class="prop-group">
                    <div class="prop-label">Position</div>
                    <div class="prop-vec3">
                        <span>X</span><input type="number" step="0.1" id="prop-pos-x" title="Position X" placeholder="X">
                        <span>Y</span><input type="number" step="0.1" id="prop-pos-y" title="Position Y" placeholder="Y">
                        <span>Z</span><input type="number" step="0.1" id="prop-pos-z" title="Position Z" placeholder="Z">
                    </div>
                </div>
                <div class="prop-group">
                    <div class="prop-label">Rotation (Â°):</div>
                    <div class="prop-vec3">
                        <span>X</span><input type="number" step="1" id="prop-rot-x" title="Rotation X (degrees)" placeholder="X">
                        <span>Y</span><input type="number" step="1" id="prop-rot-y" title="Rotation Y (degrees)" placeholder="Y">
                        <span>Z</span><input type="number" step="1" id="prop-rot-z" title="Rotation Z (degrees)" placeholder="Z">
                    </div>
                </div>
                <div class="prop-group">
                    <div class="prop-label">Scale</div>
                    <div class="prop-vec3">
                        <span>X</span><input type="number" step="0.1" id="prop-scale-x" title="Scale X" placeholder="X">
                        <span>Y</span><input type="number" step="0.1" id="prop-scale-y" title="Scale Y" placeholder="Y">
                        <span>Z</span><input type="number" step="0.1" id="prop-scale-z" title="Scale Z" placeholder="Z">
                    </div>
                </div>
                <div class="input-group">
                    <label for="modificationInput">Modify with text:</label>
                    <textarea id="modificationInput" placeholder="e.g., 'make it red' or 'move up by 2'" rows="2"></textarea>
                    <button id="modify-btn" class="control-btn-small">Apply</button>
                </div>
            </div>
        </div>
        
        <div class="viewer">
            <div id="loading-indicator" class="loading-overlay hidden">
                <div class="spinner"></div>
                <div class="loading-text">Processing...</div>
            </div>
            <div class="controls">
                <button id="undo-btn" class="control-btn" disabled>Undo</button>
                <button id="redo-btn" class="control-btn" disabled>Redo</button>
                <button id="reset-view-btn" class="control-btn">Reset View</button>
                <button id="clear-scene-btn" class="control-btn">Clear Scene</button>
                <button id="export-stl-btn" class="control-btn">Export STL</button>
                <button id="export-obj-btn" class="control-btn">Export OBJ</button>
                <button id="export-gltf-btn" class="control-btn">Export GLTF</button>
            </div>
            <div class="info">
                L-Click: Rotate | R-Click: Pan | Wheel: Zoom
            </div>
        </div>
    </div>

    <!-- Blueprint Modal -->
    <div id="blueprint-modal" class="blueprint-modal-overlay hidden">
        <div class="blueprint-modal-content">
            <h2>Blueprint Confirmation</h2>
            <p>Does this look correct? Confirm to generate the full 3D model.</p>
            <div class="blueprint-views-container">
                <div class="blueprint-view">
                    <canvas id="blueprint-front-view"></canvas>
                    <div class="blueprint-label">Front View</div>
                </div>
                <div class="blueprint-view">
                    <canvas id="blueprint-top-view"></canvas>
                    <div class="blueprint-label">Top View</div>
                </div>
                <div class="blueprint-view">
                    <canvas id="blueprint-side-view"></canvas>
                    <div class="blueprint-label">Side View</div>
                </div>
            </div>
            <div class="blueprint-actions">
                <button id="cancel-blueprint-btn" class="control-btn-small delete">Cancel</button>
                <button id="confirm-blueprint-btn" class="control-btn-small">Confirm & Generate 3D</button>
            </div>
        </div>
    </div>

    <script src="script.js" type="module" defer></script>
</body>
</html>